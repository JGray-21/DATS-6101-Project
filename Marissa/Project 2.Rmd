---
title: "Group Project #1 - Confidence in the Executive Branch of the Federal Government by Different Demographic Data"
author: " Joshua Gray, Vaijayanti Deshmukh, & Marissa Mowers"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: hide
    number_sections: false
    toc: true
    toc_depth: 3
    toc_float: true
  pdf_document:
    toc: true
    toc_depth: 3
---


```{r, echo=FALSE, result='hide'}
knitr::opts_chunk$set(warning = FALSE, echo = TRUE)
library(kableExtra)
library(gssr)
library(gssrdoc)
library(ggplot2)
library(RColorBrewer)
library(knitr)
library(ezids)
library(RColorBrewer)
library(tidyverse)
library(psych)
library(broom)
library(dplyr)

file_path <- "C:\\Users\\mnmow\\OneDrive\\Desktop\\GWU\\Fall 2024\\DATS6101 Intro\\DATS-6101-Project\\Project 2\\GSS_data.csv"
gss <- read.csv(file_path)

str(gss)
```

# Polviews bivariate graph

```{r, echo=TRUE}
ggplot(gss, aes(x = as.factor(year), fill = as.factor(polviews))) +
  geom_bar(position = "dodge") + 
  scale_fill_manual(
    values = c("0" = "red", "1" = "blue"), 
    labels = c("Republican", "Democrat"), 
    name = "Political View"
  ) +
  labs(
    title = "Frequency of Political Views Over the Years",
    x = "Year",
    y = "Count"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

# Polviews bivariate graph

```{r, echo=TRUE}
ggplot(gss, aes(x = as.factor(year), fill = as.factor(pres))) +
  geom_bar(position = "dodge") + 
  scale_fill_manual(
    values = c("0" = "red", "1" = "blue"), 
    labels = c("Republican", "Democrat"), 
    name = "Political View"
  ) +
  labs(
    title = "Frequency of Political Views Over the Years",
    x = "Year",
    y = "Count"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

# Tetrachoric Correlation 

```{r, echo=FALSE}

binary_vars <- gss %>% select(polviews, pres, incumbency)

binary_vars <- binary_vars %>% mutate_all(as.numeric) %>% na.omit()
lapply(binary_vars, unique)

tetra_corr <- psych::tetrachoric(binary_vars)
print(tetra_corr$rho)

```
# Logistic Regression

## Polviews and Year

```{r, echo=TRUE}

model_year <- glm(polviews ~ age, data = gss, family = binomial)
model_year

````

## Polviews and Age

```{r, echo=TRUE}

model_age <- glm(polviews ~ year, data = gss, family = binomial)
summary(model_age)

```

## Polviews and Educ

```{r, echo=TRUE}

model_educ <- glm(polviews ~ educ, data = gss, family = binomial)
summary(model_educ)
```

## Polviews and Educ

```{r, echo=TRUE}

model_income <- glm(polviews ~ income, data = gss, family = binomial)
summary(model_income)
```

## Polviews with Age and Income

```{r, echo=TRUE}

model_a_i <- glm(polviews ~ age + income, data = gss, family = binomial)
summary(model_a_i)
```

## Polviews with Age, Income, and Education

```{r, echo=TRUE}

model_a_i_e <- glm(polviews ~ age + income + educ, data = gss, family = binomial)
summary(model_a_i_e)
```

## Polviews with Age, Income, Education, and Who R Voted For

```{r, echo=TRUE}

model_a_i_e_p <- glm(polviews ~ age + income + educ + pres, data = gss, family = binomial)
summary(model_a_i_e_p
```

## Polviews with Age, Income, Education, Who R Voted For, and Year

```{r, echo=TRUE}

model_all <- glm(polviews ~ age + income + educ + pres + year, data = gss, family = binomial)
summary(model_all)
```

## Polviews with Age, Income, Education, and an Interaction Between Who R Voted For and Incumbency

```{r, echo=TRUE}

interaction_model_wo_year <- glm(polviews ~ age + income + educ + pres * incumbency, data = gss, family = binomial)
summary(interaction_model_wo_year)
```

## Polviews with Age, Income, Education, Year, and an Interaction Between Who R Voted For and Incumbency

```{r, echo=TRUE}

interaction_model_year <- glm(polviews ~ age + income + educ + year + pres * incumbency, data = gss, family = binomial)
summary(interaction_model_year)

```
